## 1. 프로젝트 개요 (Project Overview)

* **목표:** 다수의 경쟁자가 몰리는 '레드 오션(밀집 구간)'을 피하고, 경쟁이 희박한 '블루 오션(빈틈 구간)'을 찾아내어 단독 낙찰 확률을 극대화함.
* **핵심 원리:** 발주처마다 다른 투찰 하한율을 무시하고, 변하지 않는 절대 기준인 **`기초대비사정률`**로 데이터를 표준화(Normalization)하여 분석함.
* **타겟 유저:** 입찰 담당자, 경영진 (전략적 의사결정용).

데시보드에 업로드 할수있게해야한다.  데이터전처리:  A:\1104\.claude\SKILLS\data-preprocessing       이것을 사용해서 데이터 전처리
데시보드에 업로드가 되면  A:\1104\.claude\SKILLS\data-preprocessin 이방식으로 데이터 전처리 되어서 기존의 데이터에쌓여가게해야한다.
업데이트 완료멘트가 떠야하고 이것이 가장중요하다. 

---

## 2. 시스템 아키텍처 (System Architecture)

데이터 연산의 정확성과 대량 데이터의 실시간 시각화를 위해 **Python 백엔드**와 **Modern JavaScript 프론트엔드**를 결합합니다.

| 구분                  | 기술 스택                           | 역할                                                                  |
| --------------------- | ----------------------------------- | --------------------------------------------------------------------- |
| **Backend**     | **Python (FastAPI + Pandas)** | 데이터 전처리, 기초대비사정률 계산, 이상치 제거, 시뮬레이션 로직 수행 |
| **Database**    | **PostgreSQL**                | 수년치 입찰 데이터 및 업체별 패턴 정보 저장                           |
| **Frontend**    | **React (Next.js)**           | 사용자 인터페이스 및 컴포넌트 관리                                    |
| **Vis Library** | **ECharts & D3.js**           | 대용량 산점도(Scatter) 렌더링 및 정밀 히트맵 시각화                   |
| **State**       | **Zustand**                   | 필터(기간, 종목, 금액) 및 시뮬레이션 상태 관리                        |

---

## 3. 핵심 분석 지표 정의 (Key Metrics)

이 시스템의 모든 차트는 아래 지표를 기준으로 그려집니다.

1. **기초대비사정률 (X축 표준):** $\frac{\text{투찰금액}}{\text{기초금액}} \times 100$
   * *의미: 경쟁사들이 기초금액을 기준으로 위아래 얼마만큼의 배율을 쓰는지 보여주는 절대 좌표.*
2. **낙찰 유효성 판별:**
   * *로직: (나의 투찰금액) > (당시 공고의 낙찰하한가)* 여부 검증.
3. **고정 패턴 지수 (Bot Index):**
   * *로직: 특정 업체의 기초대비사정률 표준편차($\sigma$). 0에 가까울수록 고정값을 쓰는 봇(Bot)으로 판정.*

---

## 4. 대시보드 상세 구성안 (UI/UX Layout)

화면은 좌측 컨트롤 패널과 우측 3단 분석 패널로 구성됩니다.

## 🎛️ [좌측] 컨트롤 타워 (Control Tower)

* **데이터 필터:** 기간(최근 1년/3년), 종목, 기초금액 범위 설정.
* **경쟁사 타겟팅:** 특정 경쟁사명 검색 및 선택 (복수 선택 가능).
* **분석 모드 스위치:**
  * `Mode A: 전체 시장 흐름 보기`
  * `Mode B: 경쟁사 1:1 저격 보기`

## 1️⃣ [상단] 시장 정찰 (Market Intelligence)

* **사정률 분포 히스토그램 (D3.js):**
  * **X축:** 기초대비사정률 (98.0% ~ 102.0%)
  * **Y축:** 투찰 빈도수 (업체 수)
  * **시각화:** 0.01% 단위의 막대그래프. 사람들이 가장 많이 몰린 구간(Peak)은  **빨간색** , 가장 적은 구간(Valley)은 **초록색**으로 표시.
  * **인사이트:** *"현재 시장은 기초금액의 100.15% 지점에 과열 양상을 보입니다."*

## 2️⃣ [중단] 전략 수립 (Strategy Map) - **핵심**

* **메인 차트: 사정률 시계열 산점도 (ECharts Scatter):**
  * **X축:** 시간 (공고일자)
  * **Y축:** **기초대비사정률 (절대 기준)**
  * **점(Dot):** 개별 투찰 기록.
    * ⚪ 회색: 일반 경쟁사
    * 🔴 빨간색: 낙찰자 (승리한 점들의 위치 파악)
    * 🔵 파란색: 내가 선택한 타겟 경쟁사 (그들의 패턴 추적)
  * **기능:** 마우스 드래그로 특정 사정률 구간(예: 99.8%~100.0%) 확대(Zoom). 고정 패턴을 가진 업체는 **가로 일직선**으로 나타남.
* **빈틈 포착 히트맵 (Density Heatmap):**
  * 위 산점도를 Y축 기준으로 압축하여 **'밀도'**만 보여줌.
  * **Action:** 히트맵의 **'파란색 빈 공간(Gap)'**을 클릭하면, 해당 사정률 값이 하단 시뮬레이터로 자동 전송됨.

## 3️⃣ [하단] 검증 및 시뮬레이션 (Back-testing)

* **과거 데이터 시뮬레이터:**
  * **입력:** 목표 사정률 (예: 100.125%)
  * **연산:** DB에 있는 과거 3년 치 공고의 기초금액에 100.125%를 곱해 가상 투찰.
  * **결과 출력:**
    1. **1순위 획득 횟수:** (예: 7회)
    2. **낙찰하한가 미달 탈락 횟수:** (예: 2회) - **🔴 위험 경고 표시**
    3. **최종 예상 수익금:** (예: 3.5억 원)

---

## 5. 개발 및 구현 로드맵 (Implementation Plan)

## Step 1. 데이터 전처리 (Data Preprocessing) - **Python**

1. 엑셀 데이터 로드.
2. **[필수] 파생 변수 생성:** 모든 데이터 행에 `기초대비사정률` 컬럼 추가 계산.
3. 이상치(Outlier) 제거: 사정률 95% 미만, 105% 초과 등 비정상 데이터 필터링.
4. 업체별 패턴 분석(표준편차 계산) 후 '봇(Bot)' 태그 부여.

## Step 2. 백엔드 API 구축 (Backend) - **FastAPI**

1. `GET /api/bids`: 필터 조건에 따른 투찰 데이터 반환 (JSON).
2. `POST /api/simulate`: 사용자가 입력한 사정률로 백테스팅 결과 반환.
3. `GET /api/competitors/{name}`: 특정 경쟁사의 사정률 이력 반환.

## Step 3. 프론트엔드 시각화 (Visualization) - **React + ECharts/D3**

1. **Scatter Plot 최적화:** 수만 개의 점을 찍어야 하므로 ECharts의 **WebGL(GPU 가속)** 모드 활성화.
2. **Cross-filtering 구현:** 상단 히스토그램의 특정 구간을 클릭하면, 중단 산점도가 해당 구간만 필터링되어 보이도록 연동.
3. **Interactive Simulation:** 사용자가 빈틈을 클릭하는 즉시 하단 결과가 바뀌는 반응형 UI 구현.

## Step 4. 테스트 및 튜닝 (Testing)

1. **정합성 검증:** 시뮬레이션 결과가 실제 과거 낙찰 결과와 논리적으로 맞는지 엑셀 수식과 교차 검증.
2. **리스크 민감도 조정:** '낙찰하한가 미달' 경고 기준을 보수적으로 설정 (안전 마진 확보).

---

## 6. 최종 산출물 요약 (Deliverable)

이 시스템이 완성되면 사장님은 다음과 같은 의사결정을 내릴 수 있습니다.

1. **식별:** "경쟁사 A와 B는 항상 기초금액의 100.2%에 쓴다. (붉은 선 확인)"
2. **회피:** "그러니 나는 그 구간을 피해 100.19%에 쓴다. (빈 공간 확인)"
3. **확신:** "100.19%로 썼을 때, 과거 3년 데이터 기준 낙찰 확률이 1.5배 상승한다. (시뮬레이션 결과 확인)"
